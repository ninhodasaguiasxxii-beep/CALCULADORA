<!DOCTYPE html>
<html lang="pt-BR" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4¬∫ GUERRA CALCULATOR - Pro Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        border: "hsl(240 3.7% 15.9%)",
                        background: "hsl(240 10% 3.9%)",
                        foreground: "hsl(0 0% 98%)",
                        primary: {
                            DEFAULT: "hsl(142.1 70.6% 45.3%)",
                            foreground: "hsl(144.9 58.7% 10.8%)",
                        },
                        muted: {
                            DEFAULT: "hsl(240 3.7% 15.9%)",
                            foreground: "hsl(240 5% 64.9%)",
                        },
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap');
        body { background-color: hsl(240 10% 3.9%); color: hsl(0 0% 98%); font-family: 'Inter', sans-serif; transition: background-color 0.5s ease; }
        .hover-elevate { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .hover-elevate:hover { transform: translateY(-4px); box-shadow: 0 20px 40px -20px rgba(34, 197, 94, 0.4); border-color: rgba(34, 197, 94, 0.5); }
        
        /* Team Selection Overlay */
        #team-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.98); backdrop-blur: 15px; z-index: 100; display: flex; align-items: center; justify-content: center; transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1); overflow-y: auto; }
        #team-overlay.hidden { opacity: 0; pointer-events: none; transform: scale(1.1); }
        
        .team-card { cursor: pointer; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); border: 2px solid rgba(255,255,255,0.05); padding: 2.5rem; border-radius: 32px; background: rgba(255,255,255,0.03); text-align: center; width: 320px; position: relative; overflow: hidden; }
        .team-card::before { content: ""; position: absolute; inset: 0; background: radial-gradient(circle at center, var(--hover-color, transparent) 0%, transparent 70%); opacity: 0; transition: opacity 0.4s; }
        .team-card:hover { transform: translateY(-15px) scale(1.05); background: rgba(255,255,255,0.08); }
        .team-card:hover::before { opacity: 0.15; }
        .team-card.usa { --hover-color: #3b82f6; }
        .team-card.urss { --hover-color: #ef4444; }
        .team-card.usa:hover { border-color: #3b82f6; box-shadow: 0 0 50px rgba(59, 130, 246, 0.2); }
        .team-card.urss:hover { border-color: #ef4444; box-shadow: 0 0 50px rgba(239, 68, 68, 0.2); }

        @media (max-width: 768px) {
            #team-overlay { align-items: flex-start; padding: 2rem 1rem; }
            #team-overlay .max-w-4xl { margin-top: 1rem; }
            #team-overlay h2 { font-size: 2.5rem; line-height: 1; }
            #team-overlay p.text-zinc-500 { font-size: 0.75rem; }
            .team-card { padding: 1.5rem; border-radius: 24px; width: 100%; max-width: 280px; }
            .team-card span { font-size: 1.5rem; }
            .team-card img { border-radius: 12px; }
            .flex-col.md\:flex-row { gap: 2rem !important; }
            .text-2xl.italic { font-size: 1.25rem; margin: 0.5rem 0; }
        }

        .team-flag { cursor: pointer; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); filter: grayscale(0.8); opacity: 0.5; border-radius: 4px; }
        .team-flag:hover { filter: grayscale(0.2); opacity: 0.8; transform: scale(1.1); }
        .team-flag.active { filter: grayscale(0); opacity: 1; transform: scale(1.2); outline: 2px solid var(--team-color, #22c55e); outline-offset: 4px; box-shadow: 0 0 15px var(--team-color); }
        
        /* USA Theme Variables */
        body.theme-usa { --primary-hsl: 221 83% 53%; --team-color: #3b82f6; --primary: 3b82f6; }
        body.theme-usa .text-primary { color: #3b82f6; }
        body.theme-usa .bg-primary { background-color: #3b82f6; }
        body.theme-usa .border-primary\/20 { border-color: rgba(59, 130, 246, 0.2); }
        body.theme-usa .glow-text { text-shadow: 0 0 15px rgba(59, 130, 246, 0.5); }
        body.theme-usa .hover-elevate:hover { box-shadow: 0 20px 40px -20px rgba(59, 130, 246, 0.4); border-color: rgba(59, 130, 246, 0.5); }
        body.theme-usa .war-progress-bar { background: linear-gradient(90deg, #1e3a8a, #3b82f6, #ef4444); }
        body.theme-usa input:focus { border-color: #3b82f6; box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2); }
        body.theme-usa .point-animation.text-primary { color: #3b82f6; text-shadow: 0 0 10px rgba(59, 130, 246, 0.5); }
        
        /* URSS Theme Variables */
        body.theme-urss { --primary-hsl: 0 84% 60%; --team-color: #ef4444; --primary: ef4444; }
        body.theme-urss .text-primary { color: #ef4444; }
        body.theme-urss .bg-primary { background-color: #ef4444; }
        body.theme-urss .border-primary\/20 { border-color: rgba(239, 68, 68, 0.2); }
        body.theme-urss .glow-text { text-shadow: 0 0 15px rgba(239, 68, 68, 0.5); }
        body.theme-urss .hover-elevate:hover { box-shadow: 0 20px 40px -20px rgba(239, 68, 68, 0.4); border-color: rgba(239, 68, 68, 0.5); }
        body.theme-urss .war-progress-bar { background: linear-gradient(90deg, #7f1d1d, #ef4444, #facc15); }
        body.theme-urss input:focus { border-color: #ef4444; box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.2); }
        body.theme-urss .point-animation.text-primary { color: #ef4444; text-shadow: 0 0 10px rgba(239, 68, 68, 0.5); }

        #report { border: 1px solid rgba(255,255,255,0.1); transition: all 0.4s ease; position: relative; overflow: hidden; background: rgba(0,0,0,0.4); }
        body.theme-usa #report { border-color: rgba(59, 130, 246, 0.4); background: linear-gradient(135deg, rgba(15, 23, 42, 0.9) 0%, rgba(30, 58, 138, 0.2) 100%); box-shadow: inset 0 0 20px rgba(59, 130, 246, 0.1); }
        body.theme-urss #report { border-color: rgba(239, 68, 68, 0.4); background: linear-gradient(135deg, rgba(24, 9, 9, 0.9) 0%, rgba(153, 27, 27, 0.2) 100%); box-shadow: inset 0 0 20px rgba(239, 68, 68, 0.1); }
        #report::after { content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: repeating-linear-gradient(0deg, transparent, transparent 1px, rgba(255,255,255,0.02) 1px, rgba(255,255,255,0.02) 2px); pointer-events: none; }

        input[type="number"], input[type="text"], select { background: hsl(240 3.7% 10%); border: 1px solid hsl(240 3.7% 15.9%); color: white; padding: 0.6rem; border-radius: 8px; width: 100%; transition: all 0.2s; }
        input:focus { outline: none; border-color: hsl(142.1 70.6% 45.3%); box-shadow: 0 0 0 2px rgba(34, 197, 94, 0.2); }
        input[type="checkbox"] { accent-color: hsl(142.1 70.6% 45.3%); width: 1.2rem; height: 1.2rem; cursor: pointer; }
        input[type="range"] { accent-color: hsl(142.1 70.6% 45.3%); height: 6px; background: hsl(240 3.7% 15.9%); border-radius: 99px; cursor: pointer; }
        .point-animation { pointer-events: none; position: fixed; font-weight: 900; z-index: 100; animation: floatUp 1s ease-out forwards; }
        @keyframes floatUp { 0% { transform: translateY(0); opacity: 1; scale: 1; } 100% { transform: translateY(-60px); opacity: 0; scale: 1.2; } }
        .glow-text { text-shadow: 0 0 15px rgba(34, 197, 94, 0.5); }
        .floating-intel { position: absolute; bottom: 110%; left: 0; width: 280px; background: hsl(240 10% 12%); border: 1px solid hsl(142.1 70.6% 45.3%); padding: 12px; border-radius: 12px; z-index: 60; box-shadow: 0 10px 30px rgba(0,0,0,0.5); display: none; pointer-events: none; }
        .group:hover .floating-intel { display: block; }
        
        /* Progress Bar Styles */
        .war-progress-container { width: 100%; background: hsl(240 3.7% 15.9%); height: 8px; border-radius: 4px; overflow: hidden; margin-top: 1rem; position: relative; }
        .war-progress-bar { height: 100%; background: linear-gradient(90deg, hsl(142.1 70.6% 45.3%), #22c55e); transition: width 0.5s ease-out; }
        .war-progress-info { display: flex; justify-content: space-between; font-size: 10px; font-weight: 900; text-transform: uppercase; color: hsl(240 5% 64.9%); margin-top: 0.5rem; letter-spacing: 0.05em; }
    </style>
</head>
<body class="p-4 md:p-8 min-h-screen overflow-hidden">
    <div id="team-overlay">
        <div class="max-w-4xl w-full p-8">
            <div class="text-center mb-10">
                <h2 class="text-6xl font-black tracking-tighter uppercase italic mb-4">Escolha seu <span class="text-primary glow-text">Lado</span></h2>
                <p class="text-zinc-500 font-mono text-sm tracking-widest uppercase">A 4¬™ Guerra come√ßou. Identifique-se e defina sua lealdade.</p>
            </div>
            
            <div class="max-w-md mx-auto mb-12 space-y-4">
                <input type="text" id="userName" placeholder="SEU NOME" class="text-center text-lg font-black uppercase tracking-widest border-zinc-700 bg-zinc-900/50">
                <input type="text" id="userDiscord" placeholder="@USU√ÅRIO_DISCORD" class="text-center text-lg font-black uppercase tracking-widest border-zinc-700 bg-zinc-900/50">
                <p id="overlay-error" class="text-red-500 text-[10px] font-bold uppercase tracking-widest hidden">Voc√™ precisa informar seu @Discord e selecionar um time!</p>
            </div>

            <div class="flex items-center justify-center gap-6 md:gap-12">
                <div class="team-card usa" onclick="validateAndSetTeam('usa')" onmouseenter="previewTeam('usa')" onmouseleave="previewTeam(null)">
                    <div class="relative mb-4 md:mb-6">
                        <img src="https://flagcdn.com/w640/us.png" class="w-full aspect-video object-cover rounded-xl md:rounded-2xl shadow-2xl transition-transform duration-500 group-hover:scale-110" alt="USA">
                        <div class="absolute inset-0 rounded-xl md:rounded-2xl ring-1 ring-inset ring-white/20"></div>
                    </div>
                    <span class="text-xl md:text-3xl font-black uppercase tracking-tighter text-blue-500 block mb-1 md:mb-2">USA</span>
                    <div class="h-1 w-8 md:w-12 bg-blue-600 mx-auto mb-2 md:mb-4 rounded-full"></div>
                    <p class="text-[8px] md:text-[10px] text-zinc-400 font-bold tracking-[0.2em] md:tracking-[0.3em] uppercase hidden md:block">Democracia</p>
                </div>

                <div class="text-xl md:text-2xl font-black text-zinc-700 italic">VS</div>

                <div class="team-card urss" onclick="validateAndSetTeam('urss')" onmouseenter="previewTeam('urss')" onmouseleave="previewTeam(null)">
                    <div class="relative mb-4 md:mb-6">
                        <img src="https://flagcdn.com/w640/ru.png" class="w-full aspect-video object-cover rounded-xl md:rounded-2xl shadow-2xl" alt="URSS">
                        <div class="absolute inset-0 rounded-xl md:rounded-2xl ring-1 ring-inset ring-white/20"></div>
                    </div>
                    <span class="text-xl md:text-3xl font-black uppercase tracking-tighter text-red-500 block mb-1 md:mb-2">URSS</span>
                    <div class="h-1 w-8 md:w-12 bg-red-600 mx-auto mb-2 md:mb-4 rounded-full"></div>
                    <p class="text-[8px] md:text-[10px] text-zinc-400 font-bold tracking-[0.2em] md:tracking-[0.3em] uppercase hidden md:block">Revolu√ß√£o</p>
                </div>
            </div>
        </div>
    </div>
    <div class="max-w-4xl mx-auto space-y-8">
        <header class="flex flex-col md:flex-row justify-between items-center border-b border-zinc-800 pb-8 sticky top-0 bg-background/90 backdrop-blur-xl z-50">
            <div class="text-center md:text-left mb-4 md:mb-0 w-full md:w-auto">
                <div class="flex flex-col md:flex-row md:items-center gap-4 mb-4">
                    <h1 class="text-3xl font-black tracking-tighter">CALCULADORA <span class="text-primary glow-text">GUERRA</span></h1>
                    <div class="flex items-center justify-center gap-4 bg-zinc-800/50 p-2 rounded-xl border border-zinc-700/30">
                        <div class="flex flex-col items-center gap-1">
                            <span class="text-[8px] font-bold text-zinc-500 uppercase">USA</span>
                            <img src="https://flagcdn.com/w80/us.png" onclick="setTeam('usa')" id="flag-usa" class="team-flag w-8 h-5 object-cover" alt="USA">
                        </div>
                        <div class="w-px h-6 bg-zinc-700"></div>
                        <div class="flex flex-col items-center gap-1">
                            <span class="text-[8px] font-bold text-zinc-500 uppercase">URSS</span>
                            <img src="https://flagcdn.com/w80/ru.png" onclick="setTeam('urss')" id="flag-urss" class="team-flag w-8 h-5 object-cover" alt="URSS">
                        </div>
                    </div>
                </div>
                <div class="flex items-center gap-3 mt-1 justify-center md:justify-start">
                    <p class="text-[10px] text-muted-foreground uppercase font-mono tracking-widest">System Status: Active</p>
                    <input type="date" id="reportDate" onmouseover="this.showPicker()" onchange="updateWarProgress()" class="!w-auto bg-transparent border-none text-[10px] p-0 font-mono text-primary cursor-pointer">
                </div>
                
                <!-- War Progress Bar -->
                <div class="war-progress-container">
                    <div id="warProgressBar" class="war-progress-bar" style="width: 0%"></div>
                </div>
                <div class="war-progress-info">
                    <span>In√≠cio: 02 Fev</span>
                    <span id="warProgressText">Dia 0</span>
                    <span>Fim: 15 Fev</span>
                </div>
            </div>
            <div class="text-right">
                <div id="total-points" class="text-5xl font-black text-primary glow-text">0 PTS</div>
                <p class="text-[10px] text-zinc-500 font-bold uppercase tracking-widest mt-1 text-center md:text-right">Accumulated Score</p>
            </div>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <section class="bg-zinc-900/40 border border-zinc-800/50 rounded-2xl p-6 space-y-6 hover-elevate">
                <h2 class="text-xs font-black text-primary uppercase tracking-[0.2em] flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-primary animate-pulse"></span> Tempo e Geral
                </h2>
                
                <div class="space-y-6">
                    <div class="grid grid-cols-1 gap-4">
                        <div class="flex items-center gap-2">
                            <div class="flex-1">
                                <div class="flex justify-between mb-2">
                                    <label class="text-[10px] font-bold text-zinc-400 uppercase">Horas Estudadas (Normais)</label>
                                    <span class="text-primary font-black" id="hours-val">0.0h</span>
                                </div>
                                <input type="range" id="hours" min="0" max="24" step="0.5" value="0" oninput="updateRange('hours')" class="w-full">
                            </div>
                            <input type="text" id="hours-exact" placeholder="ex: 1h30m" oninput="updateExact('hours')" class="!w-24 text-xs">
                        </div>

                        <div class="flex items-center gap-2">
                            <div class="flex-1">
                                <div class="flex justify-between mb-2">
                                    <label class="text-[10px] font-bold text-zinc-400 uppercase">Call STREAM (YPT/Disc)</label>
                                    <span class="text-primary font-black" id="streamHours-val">0.0h</span>
                                </div>
                                <input type="range" id="streamHours" min="0" max="24" step="0.5" value="0" oninput="updateRange('streamHours')" class="w-full">
                            </div>
                            <input type="text" id="streamHours-exact" placeholder="ex: 1h" oninput="updateExact('streamHours')" class="!w-24 text-xs">
                        </div>

                        <div class="flex items-center gap-2">
                            <div class="flex-1">
                                <div class="flex justify-between mb-2">
                                    <label class="text-[10px] font-bold text-zinc-400 uppercase">Call CAM (YPT/Disc)</label>
                                    <span class="text-primary font-black" id="camHours-val">0.0h</span>
                                </div>
                                <input type="range" id="camHours" min="0" max="24" step="0.5" value="0" oninput="updateRange('camHours')" class="w-full">
                            </div>
                            <input type="text" id="camHours-exact" placeholder="ex: 1h" oninput="updateExact('camHours')" class="!w-24 text-xs">
                        </div>
                    </div>

                    <div class="bg-primary/5 p-4 rounded-xl border border-primary/20 text-center">
                        <span class="text-[10px] font-bold text-zinc-500 uppercase block mb-1">Somat√≥rio Total de Tempo</span>
                        <div class="text-2xl font-black text-primary" id="total-hours-sum">0h 0m 0s</div>
                    </div>

                    <div class="flex items-center gap-2">
                        <div class="flex-1">
                            <div class="flex justify-between mb-2">
                                <label class="text-[10px] font-bold text-zinc-400 uppercase">Horas de Ouro (+50/h)</label>
                                <span class="text-primary font-black" id="madrugada-val">0.0h</span>
                            </div>
                            <input type="range" id="madrugada" min="0" max="6" step="0.5" value="0" oninput="updateRange('madrugada')" class="w-full">
                        </div>
                        <input type="text" id="madrugada-exact" placeholder="ex: 1h" oninput="updateExact('madrugada')" class="!w-24 text-xs">
                    </div>

                    <div>
                        <label class="block text-[10px] font-bold mb-1.5 text-zinc-400 uppercase">P√°ginas Lidas</label>
                        <input type="number" id="pages" value="0" min="0" oninput="calcWithAnim('pages')">
                    </div>

                    <div class="bg-zinc-800/30 p-4 rounded-xl border border-zinc-700/50">
                        <div class="flex items-center gap-3">
                            <input type="checkbox" id="workSchool" onchange="calcWithAnim('workSchool')">
                            <label class="text-sm font-bold uppercase cursor-pointer" for="workSchool">TEVE AULA/TRABALHO/FACULDADE (+300)</label>
                        </div>
                        <input type="text" id="workSchoolName" placeholder="NOME DO LOCAL" class="mt-3 text-[11px] h-9">
                    </div>
                </div>
            </section>

            <div class="space-y-8">
                <!-- REDA√á√ïES & QUEST√ïES -->
                <section class="bg-zinc-900/40 border border-zinc-800/50 rounded-2xl p-6 space-y-6 hover-elevate">
                    <h2 class="text-xs font-black text-primary uppercase tracking-[0.2em] flex items-center justify-between">
                        <span><span class="w-2 h-2 rounded-full bg-primary inline-block mr-2"></span> N√≠veis e Quest√µes</span>
                    </h2>
                    
                    <div class="space-y-6">
                        <!-- REDA√á√ÉO -->
                        <div class="space-y-3">
                            <h3 class="text-[10px] font-black text-zinc-500 uppercase">REDA√á√ÉO</h3>
                            <div class="grid grid-cols-2 gap-2">
                                <div class="relative group">
                                    <div class="bg-black/20 p-2 rounded-lg border border-zinc-800">
                                        <label class="block text-[8px] font-bold text-zinc-600 mb-1">N1 (30)</label>
                                        <input type="number" id="essay1" value="0" min="0" oninput="calcWithAnim('essay1')" class="!bg-transparent !border-none !p-0 font-bold text-lg">
                                    </div>
                                    <div class="floating-intel"><div class="text-primary text-[10px] mb-1">N√çVEL 1:</div><div class="text-zinc-400 text-[9px]">ESA, UEMA, UEA, VESTIBULARES REGIONAIS, FACULDADES PRIVADAS</div></div>
                                </div>
                                <div class="relative group">
                                    <div class="bg-black/20 p-2 rounded-lg border border-zinc-800">
                                        <label class="block text-[8px] font-bold text-zinc-600 mb-1">N2 (40)</label>
                                        <input type="number" id="essay2" value="0" min="0" oninput="calcWithAnim('essay2')" class="!bg-transparent !border-none !p-0 font-bold text-lg">
                                    </div>
                                    <div class="floating-intel"><div class="text-primary text-[10px] mb-1">N√çVEL 2:</div><div class="text-zinc-400 text-[9px]">CN; EPCAr; UERJ / UnB / UFPR, EsFCEx, ESPCEX</div></div>
                                </div>
                                <div class="relative group">
                                    <div class="bg-black/20 p-2 rounded-lg border border-zinc-800">
                                        <label class="block text-[8px] font-bold text-zinc-600 mb-1">N3 (50)</label>
                                        <input type="number" id="essay3" value="0" min="0" oninput="calcWithAnim('essay3')" class="!bg-transparent !border-none !p-0 font-bold text-lg">
                                    </div>
                                    <div class="floating-intel"><div class="text-primary text-[10px] mb-1">N√çVEL 3:</div><div class="text-zinc-400 text-[9px]">AFA, EFOMM, UNESP, ENEM</div></div>
                                </div>
                                <div class="relative group">
                                    <div class="bg-black/20 p-2 rounded-lg border border-zinc-800">
                                        <label class="block text-[8px] font-bold text-zinc-600 mb-1">N4 (60)</label>
                                        <input type="number" id="essay4" value="0" min="0" oninput="calcWithAnim('essay4')" class="!bg-transparent !border-none !p-0 font-bold text-lg">
                                    </div>
                                    <div class="floating-intel"><div class="text-primary text-[10px] mb-1">N√çVEL 4:</div><div class="text-zinc-400 text-[9px]">ITA, IME, FUVEST, UNICAMP, EN</div></div>
                                </div>
                            </div>
                        </div>

                        <!-- MAT/FIS/QUI -->
                        <div class="space-y-3 pt-3 border-t border-zinc-800/50">
                            <h3 class="text-[10px] font-black text-zinc-500 uppercase">MAT. & FIS. & QUIM.</h3>
                            <div class="grid grid-cols-4 gap-2">
                                <div class="relative group">
                                    <input type="number" id="q_mfq1" value="0" min="0" oninput="calcWithAnim('q_mfq1')" placeholder="N1" class="text-center text-xs p-1">
                                    <div class="floating-intel"><div class="text-primary text-[10px] mb-1">N√çVEL 1 (+1):</div><div class="text-zinc-400 text-[9px]">ENEM, Vest. Civil; CFN; ESA; EEAr; e, EAM</div></div>
                                </div>
                                <div class="relative group">
                                    <input type="number" id="q_mfq2" value="0" min="0" oninput="calcWithAnim('q_mfq2')" placeholder="N2" class="text-center text-xs p-1">
                                    <div class="floating-intel"><div class="text-primary text-[10px] mb-1">N√çVEL 2 (+3):</div><div class="text-zinc-400 text-[9px]">EsPCEx, FUVEST 1 fase, EPCAr</div></div>
                                </div>
                                <div class="relative group">
                                    <input type="number" id="q_mfq3" value="0" min="0" oninput="calcWithAnim('q_mfq3')" placeholder="N3" class="text-center text-xs p-1">
                                    <div class="floating-intel"><div class="text-primary text-[10px] mb-1">N√çVEL 3 (+6):</div><div class="text-zinc-400 text-[9px]">EFOMM; AFA; CN, EN, FUVEST 2 fase</div></div>
                                </div>
                                <div class="relative group">
                                    <input type="number" id="q_mfq4" value="0" min="0" oninput="calcWithAnim('q_mfq4')" placeholder="N4" class="text-center text-xs p-1">
                                    <div class="floating-intel"><div class="text-primary text-[10px] mb-1">N√çVEL 4 (+10):</div><div class="text-zinc-400 text-[9px]">ITA; IME; e, olimp√≠adas</div></div>
                                </div>
                            </div>
                        </div>

                        <!-- HUMANAS -->
                        <div class="space-y-3 pt-3 border-t border-zinc-800/50">
                            <h3 class="text-[10px] font-black text-zinc-500 uppercase">HIS, GEO, BIO & HUMANAS</h3>
                            <div class="grid grid-cols-4 gap-2">
                                <div class="relative group">
                                    <input type="number" id="q_hum1" value="0" min="0" oninput="calcWithAnim('q_hum1')" placeholder="N1" class="text-center text-xs p-1">
                                    <div class="floating-intel"><div class="text-primary text-[10px] mb-1">N√çVEL 1 (+1):</div><div class="text-zinc-400 text-[9px]">Quest√µes de fixa√ß√£o</div></div>
                                </div>
                                <div class="relative group">
                                    <input type="number" id="q_hum2" value="0" min="0" oninput="calcWithAnim('q_hum2')" placeholder="N2" class="text-center text-xs p-1">
                                    <div class="floating-intel"><div class="text-primary text-[10px] mb-1">N√çVEL 2 (+3):</div><div class="text-zinc-400 text-[9px]">Vest. Civil; e, ESA</div></div>
                                </div>
                                <div class="relative group">
                                    <input type="number" id="q_hum3" value="0" min="0" oninput="calcWithAnim('q_hum3')" placeholder="N3" class="text-center text-xs p-1">
                                    <div class="floating-intel"><div class="text-primary text-[10px] mb-1">N√çVEL 3 (+6):</div><div class="text-zinc-400 text-[9px]">CN; Olimp√≠adas; Fuvest 1¬™ Fase; EsPCEx</div></div>
                                </div>
                                <div class="relative group">
                                    <input type="number" id="q_hum4" value="0" min="0" oninput="calcWithAnim('q_hum4')" placeholder="N4" class="text-center text-xs p-1">
                                    <div class="floating-intel"><div class="text-primary text-[10px] mb-1">N√çVEL 4 (+10):</div><div class="text-zinc-400 text-[9px]">Fuvest 2¬™ Fase; Unicamp 2¬™ Fase</div></div>
                                </div>
                            </div>
                        </div>

                        <!-- PORT/ING -->
                        <div class="space-y-3 pt-3 border-t border-zinc-800/50">
                            <h3 class="text-[10px] font-black text-zinc-500 uppercase">PORT. & INGLES.</h3>
                            <div class="grid grid-cols-4 gap-2">
                                <div class="relative group">
                                    <input type="number" id="q_lin1" value="0" min="0" oninput="calcWithAnim('q_lin1')" placeholder="N1" class="text-center text-xs p-1">
                                    <div class="floating-intel"><div class="text-primary text-[10px] mb-1">N√çVEL 1 (+1):</div><div class="text-zinc-400 text-[9px]">Vest. Civil; EAM; e, CFN</div></div>
                                </div>
                                <div class="relative group">
                                    <input type="number" id="q_lin2" value="0" min="0" oninput="calcWithAnim('q_lin2')" placeholder="N2" class="text-center text-xs p-1">
                                    <div class="floating-intel"><div class="text-primary text-[10px] mb-1">N√çVEL 2 (+3):</div><div class="text-zinc-400 text-[9px]">EsPCEx; CN; EPCAr; ESA; ITA; IME</div></div>
                                </div>
                                <div class="relative group">
                                    <input type="number" id="q_lin3" value="0" min="0" oninput="calcWithAnim('q_lin3')" placeholder="N3" class="text-center text-xs p-1">
                                    <div class="floating-intel"><div class="text-primary text-[10px] mb-1">N√çVEL 3 (+6):</div><div class="text-zinc-400 text-[9px]">EEAr(BCT); AFA e Concurso P√∫blico</div></div>
                                </div>
                                <div class="relative group">
                                    <input type="number" id="q_lin4" value="0" min="0" oninput="calcWithAnim('q_lin4')" placeholder="N4" class="text-center text-xs p-1">
                                    <div class="floating-intel"><div class="text-primary text-[10px] mb-1">N√çVEL 4 (+10):</div><div class="text-zinc-400 text-[9px]">EFOMM e EN</div></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

            <section class="bg-zinc-900/40 border border-zinc-800/50 rounded-2xl p-6 space-y-6 hover-elevate">
                <h2 class="text-xs font-black text-primary uppercase tracking-[0.2em] flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-primary inline-block"></span> Eventos e Miss√µes
                </h2>
                <div class="space-y-4">
                    <div>
                        <label class="block text-[10px] font-bold text-zinc-500 uppercase mb-1.5">Kahoot (Posi√ß√£o)</label>
                        <select id="kahootPos" onchange="calcWithAnim('kahootPos')" class="text-xs">
                            <option value="0">N√£o participou</option>
                            <option value="250">Abaixo de Top 5 (250)</option>
                            <option value="500">Top 5 (500)</option>
                            <option value="1000">Top 4 (1000)</option>
                            <option value="1500">Top 3 (1500)</option>
                            <option value="2000">Top 2 (2000)</option>
                            <option value="3500">Top 1 (3500)</option>
                        </select>
                    </div>
                    <div class="bg-zinc-800/30 p-4 rounded-xl border border-zinc-700/50">
                        <div class="flex items-center gap-3">
                            <input type="checkbox" id="coletiva" onchange="calcWithAnim('coletiva')">
                            <label class="text-sm font-bold uppercase cursor-pointer" for="coletiva">FEZ LISTA COLETIVA (+500)</label>
                        </div>
                        <div class="mt-4 space-y-2">
                            <label class="block text-[10px] font-bold text-zinc-500 uppercase">Quantas pessoas fizeram a lista? (Obrigat√≥rio)</label>
                            <input type="number" id="coletivaCount" min="1" placeholder="ex: 3" oninput="calcWithAnim('coletivaCount')" class="text-xs">
                            <input type="text" id="coletivaWith" placeholder="Nomes dos participantes (Obrigat√≥rio)" oninput="calcWithAnim('coletivaWith')" class="mt-1 text-[11px] h-9">
                        </div>
                    </div>
                </div>
            </section>
            </div>
        </div>

        <!-- SIMULADO -->
        <section class="bg-primary/5 border border-primary/20 rounded-2xl p-6 space-y-6 hover-elevate">
            <h2 class="text-xs font-black text-primary uppercase tracking-[0.2em] flex items-center gap-2">
                <span class="w-2 h-2 rounded-full bg-primary inline-block"></span> Protocolo Simulado
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                <div class="flex items-center gap-4 bg-black/20 p-5 rounded-xl border border-primary/10">
                    <input type="checkbox" id="simulado" onchange="calcWithAnim('simulado')">
                    <label class="text-sm font-bold uppercase cursor-pointer">Simulado Realizado (+200)</label>
                </div>
                <div class="space-y-2">
                    <label class="text-[10px] font-bold text-zinc-500 uppercase">Precis√£o / Desempenho</label>
                    <select id="simuladoAcc" onchange="calcWithAnim('simuladoAcc')" class="text-xs">
                        <option value="none">Precis√£o < 70%</option>
                        <option value="70">Precis√£o > 70% (+180)</option>
                        <option value="90">Precis√£o > 90% (+250)</option>
                    </select>
                </div>
            </div>
        </section>

        <div class="pt-4">
            <button onclick="copyReport()" class="w-full bg-primary text-primary-foreground font-black py-5 rounded-2xl hover:scale-[1.01] transition-all active:scale-[0.98] shadow-2xl shadow-primary/20 text-lg tracking-widest uppercase">
                Copiar Relat√≥rio Formatado
            </button>
        </div>
        
        <pre id="report" class="bg-black/60 p-8 rounded-2xl border border-zinc-800/50 text-[13px] font-mono whitespace-pre-wrap leading-relaxed text-zinc-300 italic shadow-inner"></pre>
    </div>

    <script>
        document.getElementById('reportDate').valueAsDate = new Date();
        let lastPoints = 0;
        let currentTeam = null;

        function setTeam(team) {
            currentTeam = team;
            document.body.classList.remove('theme-usa', 'theme-urss');
            document.getElementById('flag-usa').classList.remove('active');
            document.getElementById('flag-urss').classList.remove('active');
            
            if (team === 'usa') {
                document.body.classList.add('theme-usa');
                document.getElementById('flag-usa').classList.add('active');
            } else if (team === 'urss') {
                document.body.classList.add('theme-urss');
                document.getElementById('flag-urss').classList.add('active');
            }
            
            // Hide the overlay to allow interaction
            document.getElementById('team-overlay').classList.add('hidden');
            setTimeout(() => {
                document.getElementById('team-overlay').style.display = 'none';
            }, 600);
            
            // Allow pointer events on the body and calculator sections
            document.body.style.overflow = 'auto';
            
            // For√ßar atualiza√ß√£o do relat√≥rio imediatamente ap√≥s selecionar o time
            updateDisplay(lastPoints);
        }

        function validateAndSetTeam(team) {
            const discord = document.getElementById('userDiscord').value.trim();
            const errorEl = document.getElementById('overlay-error');
            
            if (!discord) {
                errorEl.classList.remove('hidden');
                document.getElementById('userDiscord').classList.add('border-red-500');
                return;
            }
            
            errorEl.classList.add('hidden');
            document.getElementById('userDiscord').classList.remove('border-red-500');
            setTeam(team);
        }

        function updateWarProgress() {
            const dateInput = document.getElementById('reportDate').value;
            if (!dateInput) return;
            
            const selectedDate = new Date(dateInput + 'T12:00:00');
            const startDate = new Date('2026-02-02T00:00:00');
            const endDate = new Date('2026-02-15T23:59:59');
            
            const totalDuration = endDate - startDate;
            const currentElapsed = selectedDate - startDate;
            
            let percentage = (currentElapsed / totalDuration) * 100;
            percentage = Math.max(0, Math.min(100, percentage));
            
            const dayOfWar = Math.floor(currentElapsed / (1000 * 60 * 60 * 24)) + 1;
            const totalDays = Math.ceil(totalDuration / (1000 * 60 * 60 * 24));
            
            document.getElementById('warProgressBar').style.width = percentage + '%';
            
            if (dayOfWar < 1) {
                document.getElementById('warProgressText').innerText = 'Guerra ainda n√£o come√ßou';
            } else if (dayOfWar > totalDays) {
                document.getElementById('warProgressText').innerText = 'Guerra encerrada';
            } else {
                document.getElementById('warProgressText').innerText = `Dia ${dayOfWar} de ${totalDays}`;
            }
        }

        // Initialize progress
        setTimeout(updateWarProgress, 100);

        function timeToHours(timeStr) {
            if (!timeStr || typeof timeStr !== 'string') return 0;
            // Handle X.5 format
            if (!isNaN(timeStr) || (timeStr.includes('.') && !timeStr.toLowerCase().includes('h'))) {
                return parseFloat(timeStr) || 0;
            }
            
            let hours = 0;
            const hMatch = timeStr.match(/(\d+(\.\d+)?)h/i);
            const mMatch = timeStr.match(/(\d+)m/i);
            const sMatch = timeStr.match(/(\d+)s/i);
            
            if (hMatch) hours += parseFloat(hMatch[1]);
            if (mMatch) hours += parseInt(mMatch[1]) / 60;
            if (sMatch) hours += parseInt(sMatch[1]) / 3600;
            
            return hours || 0;
        }

        function formatHMS(h) {
            const hrs = Math.floor(h);
            const mins = Math.floor(Math.round((h - hrs) * 60 * 100) / 100);
            const secs = Math.round(((h - hrs) * 60 - mins) * 60);
            return `${hrs}h ${mins}m ${secs}s`;
        }

        function updateRange(id) {
            const val = parseFloat(document.getElementById(id).value);
            document.getElementById(id + '-val').innerText = val.toFixed(1) + 'h';
            document.getElementById(id + '-exact').value = val.toFixed(1) + 'h';
            calcWithAnim(id);
        }

        function updateExact(id) {
            const valStr = document.getElementById(id + '-exact').value;
            const h = timeToHours(valStr);
            document.getElementById(id).value = h;
            document.getElementById(id + '-val').innerText = h.toFixed(1) + 'h';
            calcWithAnim(id);
        }

        function showPointPop(points, elementId) {
            if (points === 0) return;
            const el = document.getElementById(elementId);
            if (!el) return;
            const rect = el.getBoundingClientRect();
            const pop = document.createElement('div');
            pop.innerText = points > 0 ? `+${points}` : points;
            pop.className = `point-animation ${points > 0 ? 'text-primary' : 'text-red-500'}`;
            pop.style.left = `${rect.left + rect.width / 2}px`;
            pop.style.top = `${rect.top}px`;
            document.body.appendChild(pop);
            setTimeout(() => pop.remove(), 1000);
        }

        function calcWithAnim(triggerId) {
            const currentTotal = calculateTotal();
            const diff = Math.floor(currentTotal - lastPoints);
            if (diff !== 0) showPointPop(diff, triggerId);
            lastPoints = currentTotal;
            updateDisplay(currentTotal);
        }

        function generateReport(total) {
            const dateInput = document.getElementById('reportDate').value;
            const date = dateInput ? dateInput.split('-').reverse().join('/') : '';
            
            const userName = document.getElementById('userName').value || 'AGENTE';
            let userDiscord = document.getElementById('userDiscord').value.trim() || 'DESCONHECIDO';
            if (userDiscord !== 'DESCONHECIDO' && !userDiscord.startsWith('@')) {
                userDiscord = '@' + userDiscord;
            }

            const teamInfo = currentTeam === 'usa' ? 'üá∫üá∏ ESTADOS UNIDOS' : 
                           currentTeam === 'urss' ? '‚ò≠ UNI√ÉO SOVI√âTICA' : 'NENHUM TIME SELECIONADO';

            const hRaw = document.getElementById('hours-exact').value;
            const shRaw = document.getElementById('streamHours-exact').value;
            const chRaw = document.getElementById('camHours-exact').value;
            const madRaw = document.getElementById('madrugada-exact').value;
            
            const h = timeToHours(hRaw);
            const sh = timeToHours(shRaw);
            const ch = timeToHours(chRaw);
            const mad = timeToHours(madRaw);
            const pages = parseInt(document.getElementById('pages').value) || 0;

            const totalH = h + sh + ch;
            const metaBatida = totalH >= 3;
            
            const e1 = parseInt(document.getElementById('essay1').value) || 0;
            const e2 = parseInt(document.getElementById('essay2').value) || 0;
            const e3 = parseInt(document.getElementById('essay3').value) || 0;
            const e4 = parseInt(document.getElementById('essay4').value) || 0;
            
            const q_mfq1 = parseInt(document.getElementById('q_mfq1').value) || 0;
            const q_mfq2 = parseInt(document.getElementById('q_mfq2').value) || 0;
            const q_mfq3 = parseInt(document.getElementById('q_mfq3').value) || 0;
            const q_mfq4 = parseInt(document.getElementById('q_mfq4').value) || 0;
            
            const q_hum1 = parseInt(document.getElementById('q_hum1').value) || 0;
            const q_hum2 = parseInt(document.getElementById('q_hum2').value) || 0;
            const q_hum3 = parseInt(document.getElementById('q_hum3').value) || 0;
            const q_hum4 = parseInt(document.getElementById('q_hum4').value) || 0;
            
            const q_lin1 = parseInt(document.getElementById('q_lin1').value) || 0;
            const q_lin2 = parseInt(document.getElementById('q_lin2').value) || 0;
            const q_lin3 = parseInt(document.getElementById('q_lin3').value) || 0;
            const q_lin4 = parseInt(document.getElementById('q_lin4').value) || 0;

            const shHours = sh;
            const chHours = ch;
            let multText = "1.0x (Normal)";
            if (shHours > 0 && chHours > 0) multText = "1.6x (Foco M√°ximo)";
            else if (shHours > 0 || chHours > 0) multText = "1.3x (Foco V√≠deo)";

            let report = `[RELAT√ìRIO DE DESEMPENHO - ${date}]\n`;
            report += `SOLDADO: ${userName} (${userDiscord})\n`;
            report += `TIME: ${teamInfo}\n`;
            report += `-------------------------------------------\n`;
            
            if (h > 0) report += `TEMPO DE ESTUDO: ${hRaw} (Normais)\n`;
            if (sh > 0 || ch > 0) report += `CHAMADAS: ${shRaw || '0h'} Stream / ${chRaw || '0h'} Cam\n`;
            
            if (totalH > 0) {
                report += `TEMPO TOTAL: ${document.getElementById('total-hours-sum').innerText}\n`;
                if (!metaBatida) {
                    report += `‚ö†Ô∏è META DI√ÅRIA: N√ÉO BATIDA (-300 PTS)\n`;
                } else {
                    report += `‚úÖ META DI√ÅRIA: BATIDA (M√≠n. 3h)\n`;
                }
                report += `FOCO: ${multText}\n`;
            }
            
            if (mad > 0) report += `HORAS DE OURO: ${madRaw}\n`;
            if (pages > 0) report += `P√ÅGINAS LIDAS: ${pages}\n`;
            
            let essayLine = "";
            if (e1 > 0) essayLine += `${e1} N1 | `;
            if (e2 > 0) essayLine += `${e2} N2 | `;
            if (e3 > 0) essayLine += `${e3} N3 | `;
            if (e4 > 0) essayLine += `${e4} N4 | `;
            if (essayLine) report += `REDA√á√ïES: ${essayLine.slice(0, -3)}\n`;

            let mfqLine = "";
            if (q_mfq1 > 0) mfqLine += `${q_mfq1} N1 | `;
            if (q_mfq2 > 0) mfqLine += `${q_mfq2} N2 | `;
            if (q_mfq3 > 0) mfqLine += `${q_mfq3} N3 | `;
            if (q_mfq4 > 0) mfqLine += `${q_mfq4} N4 | `;
            if (mfqLine) report += `QUEST√ïES MFQ: ${mfqLine.slice(0, -3)}\n`;

            let humLine = "";
            if (q_hum1 > 0) humLine += `${q_hum1} N1 | `;
            if (q_hum2 > 0) humLine += `${q_hum2} N2 | `;
            if (q_hum3 > 0) humLine += `${q_hum3} N3 | `;
            if (q_hum4 > 0) humLine += `${q_hum4} N4 | `;
            if (humLine) report += `QUEST√ïES HUMANAS: ${humLine.slice(0, -3)}\n`;

            let linLine = "";
            if (q_lin1 > 0) linLine += `${q_lin1} N1 | `;
            if (q_lin2 > 0) linLine += `${q_lin2} N2 | `;
            if (q_lin3 > 0) linLine += `${q_lin3} N3 | `;
            if (q_lin4 > 0) linLine += `${q_lin4} N4 | `;
            if (linLine) report += `QUEST√ïES LINGUAGENS: ${linLine.slice(0, -3)}\n`;
            
            const work = document.getElementById('workSchool').checked;
            const coletiva = document.getElementById('coletiva').checked;
            const simulado = document.getElementById('simulado').checked;

            if (work || coletiva || simulado) {
                report += `-------------------------------------------\n`;
                if (work) report += `TEVE AULA/TRABALHO: SIM (${document.getElementById('workSchoolName').value || 'N√£o informado'})\n`;
                if (coletiva) {
                    const cCount = document.getElementById('coletivaCount').value || '?';
                    report += `LISTA COLETIVA: SIM (${cCount} pessoas - Com: ${document.getElementById('coletivaWith').value || 'N√£o informado'})\n`;
                }
                if (simulado) report += `SIMULADO: REALIZADO\n`;
            }

            report += `-------------------------------------------\n`;
            report += `PONTUA√á√ÉO FINAL: ${Math.floor(total).toLocaleString()} PTS\n`;
            document.getElementById('report').innerText = report;
        }

        function previewTeam(team) {
            if (!team) {
                document.body.style.backgroundColor = 'hsl(240 10% 3.9%)';
                return;
            }
            document.body.style.backgroundColor = team === 'usa' ? 'rgba(59, 130, 246, 0.05)' : 'rgba(239, 68, 68, 0.05)';
        }

        function calculateTotal() {
            let total = 0;
            const getV = (id) => parseFloat(document.getElementById(id).value) || 0;
            const getExactV = (id) => timeToHours(document.getElementById(id + '-exact').value) || 0;
            const isC = (id) => document.getElementById(id).checked;

            const h = getExactV('hours');
            const sh = getExactV('streamHours');
            const ch = getExactV('camHours');
            const mad = getExactV('madrugada');
            
            const totalH = h + sh + ch;
            
            // Meta di√°ria: -300 se totalH < 3
            if (totalH < 3) {
                total -= 300;
            }

            // Base time points
            let timePoints = totalH * 100;
            
            // Automatic Multipliers
            if (sh > 0 && ch > 0) {
                timePoints *= 1.6;
            } else if (sh > 0 || ch > 0) {
                timePoints *= 1.3;
            }
            
            total += timePoints;

            if (totalH >= 12) total += 300;
            else if (totalH >= 8) total += 200;
            else if (totalH >= 5) total += 100;
            else if (totalH >= 3) total += 50;

            total += mad * 50;
            if (isC('workSchool')) total += 300;
            total += Math.floor(getV('pages') / 20) * 8;

            total += getV('essay1') * 30 + getV('essay2') * 40 + getV('essay3') * 50 + getV('essay4') * 60;
            
            const q_mfq = getV('q_mfq1') * 1 + getV('q_mfq2') * 3 + getV('q_mfq3') * 6 + getV('q_mfq4') * 10;
            const q_hum = getV('q_hum1') * 1 + getV('q_hum2') * 3 + getV('q_hum3') * 6 + getV('q_hum4') * 10;
            const q_lin = getV('q_lin1') * 1 + getV('q_lin2') * 3 + getV('q_lin3') * 6 + getV('q_lin4') * 10;
            total += q_mfq + q_hum + q_lin;

            total += parseInt(document.getElementById('kahootPos').value) || 0;
            if (isC('coletiva')) total += 500;

            if (isC('simulado')) {
                total += 200;
                const acc = document.getElementById('simuladoAcc').value;
                if (acc === '70') total += 180;
                if (acc === '90') total += 250;
            }

            // Final Update for Display
            updateDisplay(total);
            return total;
        }

        function updateDisplay(total) {
            document.getElementById('total-points').innerText = Math.floor(total).toLocaleString() + " PTS";
            const h = timeToHours(document.getElementById('hours-exact').value) || 0;
            const sh = timeToHours(document.getElementById('streamHours-exact').value) || 0;
            const ch = timeToHours(document.getElementById('camHours-exact').value) || 0;
            document.getElementById('total-hours-sum').innerText = formatHMS(h + sh + ch);
            generateReport(total);
        }

        function copyReport() {
            const coletivaCheck = document.getElementById('coletiva').checked;
            const coletivaWith = document.getElementById('coletivaWith').value.trim();
            
            if (coletivaCheck && !coletivaWith) {
                alert("ERRO: Para copiar o relat√≥rio com Lista Coletiva, voc√™ deve informar quem participou!");
                document.getElementById('coletivaWith').focus();
                document.getElementById('coletivaWith').classList.add('border-red-500');
                return;
            }
            
            document.getElementById('coletivaWith').classList.remove('border-red-500');
            const text = document.getElementById('report').innerText;
            navigator.clipboard.writeText(text).then(() => {
                const btn = document.querySelector('button[onclick="copyReport()"]');
                const old = btn.innerText;
                btn.innerText = "COPIADO COM SUCESSO!";
                setTimeout(() => btn.innerText = old, 2000);
            });
        }
        updateDisplay(0);
    </script>
</body>
</html>
